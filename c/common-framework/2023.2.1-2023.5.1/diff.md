# Comparing `tmp/common_framework-2023.2.1-py3-none-any.whl.zip` & `tmp/common_framework-2023.5.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,40 +1,40 @@
-Zip file size: 160493 bytes, number of entries: 71
--rw-r--r--  2.0 unx      103 b- defN 23-Mar-21 14:37 common/__init__.py
+Zip file size: 161436 bytes, number of entries: 71
+-rw-r--r--  2.0 unx      103 b- defN 23-May-09 13:46 common/__init__.py
 -rw-r--r--  2.0 unx    25165 b- defN 23-Mar-21 14:36 common/admin.py
 -rw-r--r--  2.0 unx      625 b- defN 21-Jun-29 15:20 common/apps.py
 -rw-r--r--  2.0 unx     4053 b- defN 21-Jun-29 15:24 common/auth.py
 -rw-r--r--  2.0 unx     4559 b- defN 21-Jun-29 15:24 common/commands.py
 -rw-r--r--  2.0 unx    23004 b- defN 23-Mar-21 14:36 common/excel.py
 -rw-r--r--  2.0 unx    27464 b- defN 23-Mar-21 14:36 common/fields.py
 -rw-r--r--  2.0 unx    13777 b- defN 23-Mar-21 14:36 common/forms.py
 -rw-r--r--  2.0 unx     4310 b- defN 21-Jun-29 15:24 common/logger.py
 -rw-r--r--  2.0 unx     4939 b- defN 23-Mar-21 14:36 common/middleware.py
--rw-r--r--  2.0 unx    98921 b- defN 23-Mar-21 14:36 common/models.py
+-rw-r--r--  2.0 unx   100327 b- defN 23-May-09 13:51 common/models.py
 -rw-r--r--  2.0 unx     6171 b- defN 23-Feb-13 20:52 common/operations.py
 -rw-r--r--  2.0 unx     4886 b- defN 21-Jun-29 15:24 common/router.py
 -rw-r--r--  2.0 unx     3802 b- defN 21-Jun-29 15:24 common/runtests.py
 -rw-r--r--  2.0 unx     1361 b- defN 22-Aug-12 16:06 common/settings.py
 -rw-r--r--  2.0 unx      103 b- defN 18-Feb-03 17:24 common/tasks.py
 -rw-r--r--  2.0 unx      448 b- defN 21-Jun-29 15:24 common/urls.py
--rw-r--r--  2.0 unx    66910 b- defN 23-Mar-21 14:36 common/utils.py
+-rw-r--r--  2.0 unx    67037 b- defN 23-May-23 08:46 common/utils.py
 -rw-r--r--  2.0 unx     2956 b- defN 22-May-30 18:05 common/views.py
 -rw-r--r--  2.0 unx     2760 b- defN 21-Jun-29 15:24 common/websocket.py
 -rw-r--r--  2.0 unx       16 b- defN 18-Feb-03 17:24 common/api/__init__.py
 -rw-r--r--  2.0 unx     5107 b- defN 23-Mar-21 14:36 common/api/api_views.py
 -rw-r--r--  2.0 unx     2501 b- defN 22-Jan-31 15:19 common/api/base.py
 -rw-r--r--  2.0 unx     1730 b- defN 23-Mar-21 14:36 common/api/config.py
 -rw-r--r--  2.0 unx     5887 b- defN 23-Mar-21 14:36 common/api/fields.py
 -rw-r--r--  2.0 unx     1521 b- defN 21-Jun-29 15:20 common/api/input_serializers.py
 -rw-r--r--  2.0 unx     1928 b- defN 21-Jun-29 15:20 common/api/pagination.py
 -rw-r--r--  2.0 unx     1778 b- defN 21-Jun-29 15:20 common/api/permissions.py
 -rw-r--r--  2.0 unx     1237 b- defN 22-Jan-31 10:51 common/api/renderers.py
 -rw-r--r--  2.0 unx    12660 b- defN 23-Mar-21 14:36 common/api/serializers.py
 -rw-r--r--  2.0 unx      768 b- defN 21-Jun-29 15:20 common/api/urls.py
--rw-r--r--  2.0 unx    60710 b- defN 23-Mar-21 14:36 common/api/utils.py
+-rw-r--r--  2.0 unx    63718 b- defN 23-May-23 08:44 common/api/utils.py
 -rw-r--r--  2.0 unx    25786 b- defN 23-Mar-21 14:36 common/api/viewsets.py
 -rw-rw-r--  2.0 unx    13644 b- defN 21-Jun-29 19:54 common/locale/en/LC_MESSAGES/django.mo
 -rw-rw-r--  2.0 unx    13366 b- defN 21-Jun-29 19:52 common/locale/en/LC_MESSAGES/django.po
 -rw-rw-r--  2.0 unx    14751 b- defN 21-Jun-29 15:03 common/locale/fr/LC_MESSAGES/django.mo
 -rw-rw-r--  2.0 unx    14473 b- defN 21-Jun-29 15:02 common/locale/fr/LC_MESSAGES/django.po
 -rw-r--r--  2.0 unx      713 b- defN 21-Jun-29 15:20 common/management/__init__.py
 -rw-r--r--  2.0 unx       29 b- defN 18-Feb-03 17:24 common/management/commands/__init__.py
@@ -61,13 +61,13 @@
 -rw-rw-r--  2.0 unx     6391 b- defN 22-Jan-31 14:00 common/templates/common/scripts.js
 -rw-r--r--  2.0 unx       29 b- defN 18-Feb-03 17:24 common/templatetags/__init__.py
 -rw-r--r--  2.0 unx    15293 b- defN 23-Mar-21 14:36 common/templatetags/tools.py
 -rw-r--r--  2.0 unx    25744 b- defN 23-Feb-13 20:27 common/tests/__init__.py
 -rw-r--r--  2.0 unx      311 b- defN 22-Jan-31 16:13 common/tests/test_api.py
 -rw-r--r--  2.0 unx     8252 b- defN 21-Jun-29 15:20 common/tests/test_utils.py
 -rw-r--r--  2.0 unx      494 b- defN 21-Jun-29 15:24 common/tests/urls.py
--rw-rw-r--  2.0 unx     1023 b- defN 23-Mar-21 14:40 common_framework-2023.2.1.dist-info/LICENSE.txt
--rw-r--r--  2.0 unx    22963 b- defN 23-Mar-21 14:40 common_framework-2023.2.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Mar-21 14:40 common_framework-2023.2.1.dist-info/WHEEL
--rw-r--r--  2.0 unx      114 b- defN 23-Mar-21 14:40 common_framework-2023.2.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     5991 b- defN 23-Mar-21 14:40 common_framework-2023.2.1.dist-info/RECORD
-71 files, 594537 bytes uncompressed, 151055 bytes compressed:  74.6%
+-rw-rw-r--  2.0 unx     1023 b- defN 23-May-23 08:57 common_framework-2023.5.1.dist-info/LICENSE.txt
+-rw-r--r--  2.0 unx    23092 b- defN 23-May-23 08:57 common_framework-2023.5.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-23 08:57 common_framework-2023.5.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx      114 b- defN 23-May-23 08:57 common_framework-2023.5.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     5992 b- defN 23-May-23 08:57 common_framework-2023.5.1.dist-info/RECORD
+71 files, 599208 bytes uncompressed, 151998 bytes compressed:  74.6%
```

## zipnote {}

```diff
@@ -192,23 +192,23 @@
 
 Filename: common/tests/test_utils.py
 Comment: 
 
 Filename: common/tests/urls.py
 Comment: 
 
-Filename: common_framework-2023.2.1.dist-info/LICENSE.txt
+Filename: common_framework-2023.5.1.dist-info/LICENSE.txt
 Comment: 
 
-Filename: common_framework-2023.2.1.dist-info/METADATA
+Filename: common_framework-2023.5.1.dist-info/METADATA
 Comment: 
 
-Filename: common_framework-2023.2.1.dist-info/WHEEL
+Filename: common_framework-2023.5.1.dist-info/WHEEL
 Comment: 
 
-Filename: common_framework-2023.2.1.dist-info/top_level.txt
+Filename: common_framework-2023.5.1.dist-info/top_level.txt
 Comment: 
 
-Filename: common_framework-2023.2.1.dist-info/RECORD
+Filename: common_framework-2023.5.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## common/__init__.py

```diff
@@ -1,5 +1,5 @@
 # coding: utf-8
 __all__ = []
-__version__ = "2023.2.1"
+__version__ = "2023.5.1"
 
 default_app_config = "common.apps.CommonConfig"
```

## common/models.py

```diff
@@ -1262,25 +1262,37 @@
         if django_version >= (4,):
             del_query.query.clear_ordering(force=True)
         else:
             del_query.query.clear_ordering(force_empty=True)
 
         collector = Collector(using=del_query.db)
         collector.collect(del_query)
-        self._collector_update = {
-            key._meta.label: {
-                field.name: [instance.pk for instance in instances] for (field, value), instances in value.items()
+        if django_version >= (4, 2):
+            del_query.query.clear_ordering(force=True)
+            self._collector_update = {}
+            for (field, value), querysets in collector.field_updates.items():
+                ids = self._collector_update.setdefault(field.model._meta.label, {}).setdefault(field.name, set())
+                ids.update(*(queryset.values_list("pk", flat=True) for queryset in querysets))
+            self._collector_delete = {
+                model._meta.label: [to_dict(instance) for instance in instances]
+                for model, instances in collector.data.items()
+                if model._meta.auto_created
+            }
+        else:
+            self._collector_update = {
+                model._meta.label: {
+                    field.name: [instance.pk for instance in instances] for (field, value), instances in data.items()
+                }
+                for model, data in collector.field_updates.items()
+            }
+            self._collector_delete = {
+                model._meta.label: [to_dict(instance) for instance in instances]
+                for model, instances in collector.data.items()
+                if model._meta.auto_created
             }
-            for key, value in collector.field_updates.items()
-        }
-        self._collector_delete = {
-            key._meta.label: [to_dict(value, excludes=("id",)) for value in values]
-            for key, values in collector.data.items()
-            if key._meta.auto_created
-        }
         deleted, _rows_count = collector.delete()
 
         self._result_cache = None
         return deleted, _rows_count
 
     def create(
         self,
@@ -1446,25 +1458,36 @@
         self._force_default = _force_default or self._force_default
 
         from django.db import router
 
         using = kwargs.get("using", False) or router.db_for_write(self.__class__, instance=self)
         collector = Collector(using=using)
         collector.collect([self], keep_parents=keep_parents)
-        self._collector_update = {
-            key._meta.label: {
-                field.name: [instance.pk for instance in instances] for (field, value), instances in value.items()
+        if django_version >= (4, 2):
+            self._collector_update = {}
+            for (field, value), querysets in collector.field_updates.items():
+                ids = self._collector_update.setdefault(field.model._meta.label, {}).setdefault(field.name, set())
+                ids.update(*(queryset.values_list("pk", flat=True) for queryset in querysets))
+            self._collector_delete = {
+                model._meta.label: [to_dict(instance) for instance in instances]
+                for model, instances in collector.data.items()
+                if model._meta.auto_created
+            }
+        else:
+            self._collector_update = {
+                model._meta.label: {
+                    field.name: [instance.pk for instance in instances] for (field, value), instances in data.items()
+                }
+                for model, data in collector.field_updates.items()
+            }
+            self._collector_delete = {
+                model._meta.label: [to_dict(instance) for instance in instances]
+                for model, instances in collector.data.items()
+                if model._meta.auto_created
             }
-            for key, value in collector.field_updates.items()
-        }
-        self._collector_delete = {
-            key._meta.label: [to_dict(value, excludes=("id",)) for value in values]
-            for key, values in collector.data.items()
-            if key._meta.auto_created
-        }
         for instances in collector.data.values():
             for instance in instances:
                 instance._ignore_log = self._ignore_log
                 instance._current_user = self._current_user
                 instance._reason = self._reason
                 instance._force_default = self._force_default
                 instance._from_admin = self._from_admin
@@ -2428,15 +2451,15 @@
     """
     data = {}
     if not instance:
         return None
     elif isinstance(instance, CommonModel):
         data = instance.to_dict(types=types, **options)
     elif isinstance(instance, models.Model):
-        data = model_to_dict(instance)
+        data = model_to_dict(instance, **options)
         data.pop("_state", None)  # Donnée non serialisable
         if types:
             content_type = ContentType.objects.get_for_model(instance)
             data.update(_content_type=to_dict(content_type, types=False))
     elif hasattr(instance, "__dict__"):
         data = instance.__dict__
     elif hasattr(instance, "__slots__"):
@@ -2457,19 +2480,19 @@
     :param instance: Instance
     :param fields: Champs à inclures (organisés par modèle)
     :param exclude: Champs à inclures (organisés par modèle)
     :return: Dictionnaire
     """
     model = instance._meta.model
     includes, excludes = (fields or kwargs.pop("includes", {}) or {}, exclude or kwargs.pop("excludes", {}) or {})
-    fields = includes.get(model) if isinstance(includes, dict) else includes
-    exclude = excludes.get(model) if isinstance(excludes, dict) else excludes
     if isinstance(instance, CommonModel):
         data = instance.to_dict(includes=includes, excludes=excludes, **kwargs)
     else:
+        fields = includes.get(model) if isinstance(includes, dict) else includes
+        exclude = excludes.get(model) if isinstance(excludes, dict) else excludes
         data = django_model_to_dict(instance, fields=fields, exclude=exclude)
         for key, value in data.items():
             if isinstance(value, models.Model):
                 data[key] = model_to_dict(value, fields=fields, exclude=exclude)
             elif isinstance(value, list) and value and isinstance(value[0], models.Model):
                 data[key] = [model_to_dict(item, fields=fields, exclude=exclude) for item in value]
     return data
```

## common/utils.py

```diff
@@ -961,18 +961,21 @@
 
 def str_to_bool(value):
     """
     Permet de renvoyer le booleen correspondant à la valeur entrée en paramètre
     :param value: valeur à analyser
     :return: le booleen correspondant ou None si aucune correspondance
     """
+    if isinstance(value, bool):
+        return value
+    if not value or not isinstance(value, str):
+        return bool(value)
     # Valeurs considérées comme vraies ou fausses (déclarées dans la fonction à cause du moteur i18n)
     TRUE_VALUES = {"true", "yes", "y", "1", _("vrai"), _("oui"), _("o"), _("v")}
     FALSE_VALUES = {"false", "no", "n", "0", _("faux"), _("non"), _("n"), _("f")}
-
     if value is True or value is False:
         return value
     if value is None or str(value).lower() not in TRUE_VALUES | FALSE_VALUES:
         return None
     return str(value).lower() in TRUE_VALUES
```

## common/api/utils.py

```diff
@@ -1,18 +1,19 @@
 # coding: utf-8
 import ast
 import re
 import zoneinfo
 from datetime import timedelta
-from functools import wraps
+from functools import wraps, partial
 from json import JSONDecodeError
 
-from django.contrib.postgres import aggregates as pg_aggregates
+from django import VERSION as django_version
+from django.contrib.postgres import aggregates as pg_aggregates, search as pg_search
 from django.core.exceptions import EmptyResultSet
-from django.db import models
+from django.db import connection, models
 from django.db.models import F, Q, QuerySet, Value, aggregates, functions
 from django.utils.timezone import now
 from rest_framework import serializers, viewsets
 from rest_framework.decorators import api_view
 from rest_framework.exceptions import NotFound, PermissionDenied, ValidationError
 from rest_framework.relations import PrimaryKeyRelatedField
 from rest_framework.response import Response
@@ -28,47 +29,53 @@
     get_related,
     json_decode,
     parsedate,
     prefetch_metadata,
     str_to_bool,
 )
 
+is_postgresql = connection.vendor == "postgresql"
+
 # URLs dans les serializers
 HYPERLINKED = settings.REST_FRAMEWORK.get("HYPERLINKED", False)
 
-
 # Mots clés réservés dans les URLs des APIs
 AGGREGATES = {
     "count": aggregates.Count,
     "sum": aggregates.Sum,
     "avg": aggregates.Avg,
     "min": aggregates.Min,
     "max": aggregates.Max,
     "stddev": aggregates.StdDev,
     "variance": aggregates.Variance,
-    "arrayagg": pg_aggregates.ArrayAgg,
-    "bitand": pg_aggregates.BitAnd,
-    "bitor": pg_aggregates.BitOr,
-    "bitxor": pg_aggregates.BitXor,
-    "booland": pg_aggregates.BoolAnd,
-    "boolor": pg_aggregates.BoolOr,
-    "jsonbagg": pg_aggregates.JSONBAgg,
-    "stringagg": pg_aggregates.StringAgg,
-    "corr": pg_aggregates.Corr,
-    "covarpop": pg_aggregates.CovarPop,
-    "regravgx": pg_aggregates.RegrAvgX,
-    "regravgy": pg_aggregates.RegrAvgY,
-    "regrcount": pg_aggregates.RegrCount,
-    "regrintercept": pg_aggregates.RegrIntercept,
-    "regrr2": pg_aggregates.RegrR2,
-    "regrslope": pg_aggregates.RegrSlope,
-    "regrsxx": pg_aggregates.RegrSXX,
-    "regrsxy": pg_aggregates.RegrSXY,
-    "regrsyy": pg_aggregates.RegrSYY,
 }
+if is_postgresql:
+    AGGREGATES.update(
+        {
+            "arrayagg": pg_aggregates.ArrayAgg,
+            "bitand": pg_aggregates.BitAnd,
+            "bitor": pg_aggregates.BitOr,
+            "bitxor": pg_aggregates.BitXor,
+            "booland": pg_aggregates.BoolAnd,
+            "boolor": pg_aggregates.BoolOr,
+            "jsonbagg": pg_aggregates.JSONBAgg,
+            "stringagg": pg_aggregates.StringAgg,
+            "corr": pg_aggregates.Corr,
+            "covarpop": pg_aggregates.CovarPop,
+            "regravgx": pg_aggregates.RegrAvgX,
+            "regravgy": pg_aggregates.RegrAvgY,
+            "regrcount": pg_aggregates.RegrCount,
+            "regrintercept": pg_aggregates.RegrIntercept,
+            "regrr2": pg_aggregates.RegrR2,
+            "regrslope": pg_aggregates.RegrSlope,
+            "regrsxx": pg_aggregates.RegrSXX,
+            "regrsxy": pg_aggregates.RegrSXY,
+            "regrsyy": pg_aggregates.RegrSYY,
+        }
+    )
 CASTS = {
     "bool": models.BooleanField(),
     "date": models.DateField(),
     "datetime": models.DateTimeField(),
     "decimal": models.DecimalField(),
     "float": models.FloatField(),
     "int": models.IntegerField(),
@@ -152,14 +159,34 @@
     "sha384": functions.SHA384,
     "sha512": functions.SHA512,
     "strindex": functions.StrIndex,
     "substr": functions.Substr,
     "trim": functions.Trim,
     "upper": functions.Upper,
 }
+if is_postgresql:
+    FUNCTIONS.update(
+        {
+            # Search
+            "search_vector": pg_search.SearchVector,
+            "search_rank": pg_search.SearchRank,
+            "search_headline": pg_search.SearchHeadline,
+            "trigram_similarity": pg_search.TrigramSimilarity,
+            "trigram_word_similarity": pg_search.TrigramWordSimilarity,
+            "trigram_distance": pg_search.TrigramDistance,
+            "trigram_word_distance": pg_search.TrigramWordDistance,
+        }
+    )
+    if django_version >= (4, 2):
+        FUNCTIONS.update(
+            {
+                "trigram_strict_word_similarity": pg_search.TrigramStrictWordSimilarity,
+                "trigram_strict_word_distance": pg_search.TrigramStrictWordDistance,
+            }
+        )
 RESERVED_QUERY_PARAMS = (
     [
         "filters",
         "fields",
         "order_by",
         "group_by",
         "all",
@@ -173,14 +200,15 @@
     ]
     + list(AGGREGATES.keys())
     + list(FUNCTIONS.keys())
 )
 MULTI_LOOKUPS = ["__in", "__range", "__hasany", "__hasall", "__has_keys", "__has_any_keys", "__overlap"]
 BOOL_LOOKUPS = ["__isnull", "__isempty"]
 JSON_LOOKUPS = ["__contains", "__contained_by", "__hasdict", "__indict"]
+SEARCH_FORMAT = re.compile(r"(?P<search_type>\w+)\((?P<query>.*)\)(?P<config>\w+)?")
 
 
 def convert_arg(function, arg_index, arg_raw):
     """
     Transforme un argument parsé de l'API en fonction de l'annotation/aggregate utilisée
     :param function: Nom de l'annotation/aggregate
     :param arg_index: Position de l'argument
@@ -202,28 +230,46 @@
     else:
         arg_value = converts.get(arg_name or arg_index, Value)(arg_value)
     if arg_name:
         return {arg_name: arg_value}
     return arg_value
 
 
-def parse_arg_value(value):
+def parse_arg_value(value, keep=False):
     """
-    Parse une valeur d'argument afin d'en extraire le champ de base de données potentiel
+    Parse une valeur contenant une référence de champ ou une fonction de recherche
     :param value: Valeur d'argument
+    :param keep: Garde la valeur d'entrée par défaut
     :return: Valeur ou champ de base de données
     """
-    if isinstance(value, str) and value.startswith("[") and value.endswith("]"):
-        value = value[1:-1].replace(".", "__")
-        value, cast, *_ = value.split(":") + [""]
-        value = F(value)
-        if output_field := CASTS.get(cast.lower()):
-            value = functions.Cast(value, output_field=output_field)
-        return value
-    return None
+    if isinstance(value, str):
+        if value.startswith("[") and value.endswith("]"):
+            value = value[1:-1].replace(".", "__")
+            value, cast, *_ = value.split(":") + [""]
+            value = F(value)
+            if output_field := CASTS.get(cast.lower()):
+                value = functions.Cast(value, output_field=output_field)
+            return value
+        if is_postgresql and (search := SEARCH_FORMAT.match(value)):
+            params = search.groupdict()
+            query = params.get("query")
+            config = parse_arg_value(params.get("config")) or params.get("config")
+            search_type = params.pop("search_type").lower()
+            search_type = {
+                "q": "plain",
+                "p": "phrase",
+                "r": "raw",
+                "w": "websearch",
+                "v": "vector",
+            }.get(search_type, search_type)
+            if search_type == "vector":
+                return pg_search.SearchVector(*query.split(), config=config)
+            else:
+                return pg_search.SearchQuery(query, config=config, search_type=search_type)
+    return value if keep else None
 
 
 def url_value(filter, value):
     """
     Transforme la valeur dans l'URL à partir du filtre
     :param filter: Filtre
     :param value: Valeur
@@ -1355,37 +1401,39 @@
         return ordering
     if isinstance(ordering, str):
         return [item.replace(".", "__") for item in re.split(r"[^-\w\.]", ordering)]
     return None
 
 
 # Conversion des arguments des fonctions
+parse_param = partial(parse_arg_value, keep=True)
 FUNC_COMMON = {"output_field": CASTS.get}
 TRUNC_BASE_CONVERT = {
     1: str,
     2: CASTS.get,
     3: zoneinfo.ZoneInfo,
-    4: bool,
+    4: str_to_bool,
     "kind": str,
     "tzinfo": zoneinfo.ZoneInfo,
-    "is_dst": bool,
+    "is_dst": str_to_bool,
     **FUNC_COMMON,
 }
 TRUNC_CONVERT = {
     1: CASTS.get,
     2: zoneinfo.ZoneInfo,
-    3: bool,
+    3: str_to_bool,
     "tzinfo": zoneinfo.ZoneInfo,
-    "is_dst": bool,
+    "is_dst": str_to_bool,
     **FUNC_COMMON,
 }
 EXTRACT_CONVERT = {1: zoneinfo.ZoneInfo, "tzinfo": zoneinfo.ZoneInfo, **FUNC_COMMON}
 AGGREGATE_BASE = {"filter": parse_filters, "default": Value, **FUNC_COMMON}
-AGGREGATE_COMMON = {"distinct": bool, **AGGREGATE_BASE}
+AGGREGATE_COMMON = {"distinct": str_to_bool, **AGGREGATE_BASE}
 AGGREGATE_STATS = {1: str, "y": str, **AGGREGATE_BASE}
+TRIGRAM_COMMON = {1: str, 2: str}
 CONVERTS = {
     # Functions
     "cast": {1: CASTS.get, **FUNC_COMMON},
     "coalesce": {**{i: str for i in range(10)}, **FUNC_COMMON},
     "collate": {1: str, "collation": str, **FUNC_COMMON},
     "greatest": {**{i: str for i in range(10)}, **FUNC_COMMON},
     "least": {**{i: str for i in range(10)}, **FUNC_COMMON},
@@ -1427,29 +1475,51 @@
     "substr": {1: int, 2: int, "pos": int, "length": int, **FUNC_COMMON},
     # Aggregates
     "count": AGGREGATE_COMMON,
     "sum": AGGREGATE_COMMON,
     "avg": AGGREGATE_COMMON,
     "min": AGGREGATE_COMMON,
     "max": AGGREGATE_COMMON,
-    "stddev": {"sample": bool, **AGGREGATE_COMMON},
-    "variance": {"sample": bool, **AGGREGATE_COMMON},
+    "stddev": {"sample": str_to_bool, **AGGREGATE_COMMON},
+    "variance": {"sample": str_to_bool, **AGGREGATE_COMMON},
     "arrayagg": {"ordering": parse_ordering, **AGGREGATE_COMMON},
     "bitand": AGGREGATE_COMMON,
     "bitor": AGGREGATE_COMMON,
     "bitxor": AGGREGATE_COMMON,
     "booland": AGGREGATE_COMMON,
     "boolor": AGGREGATE_COMMON,
     "jsonbagg": {"ordering": parse_ordering, **AGGREGATE_COMMON},
     "stringagg": {1: str, "delimiter": str, "ordering": parse_ordering, **AGGREGATE_COMMON},
     "corr": AGGREGATE_STATS,
-    "covarpop": {2: bool, "sample": bool, **AGGREGATE_STATS},
+    "covarpop": {2: str_to_bool, "sample": str_to_bool, **AGGREGATE_STATS},
     "regravgx": AGGREGATE_STATS,
     "regravgy": AGGREGATE_STATS,
     "regrcount": AGGREGATE_STATS,
     "regrintercept": AGGREGATE_STATS,
     "regrr2": AGGREGATE_STATS,
     "regrslope": AGGREGATE_STATS,
     "regrsxx": AGGREGATE_STATS,
     "regrsxy": AGGREGATE_STATS,
     "regrsyy": AGGREGATE_STATS,
+    # Search
+    "search_vector": {"config": parse_param, "weight": str},
+    "search_rank": {1: parse_param, 2: parse_param, "weights": tuple, "cover_density": str_to_bool},
+    "search_headline": {
+        1: str,
+        2: parse_param,
+        "config": str,
+        "start_sel": str,
+        "stop_sel": str,
+        "max_words": int,
+        "min_words": int,
+        "short_word": int,
+        "highlight_all": str_to_bool,
+        "max_fragments": int,
+        "fragment_delimiter": str,
+    },
+    "trigram_similarity": TRIGRAM_COMMON,
+    "trigram_word_similarity": TRIGRAM_COMMON,
+    "trigram_distance": TRIGRAM_COMMON,
+    "trigram_word_distance": TRIGRAM_COMMON,
+    "trigram_strict_word_similarity": TRIGRAM_COMMON,
+    "trigram_strict_word_distance": TRIGRAM_COMMON,
 }
```

## Comparing `common_framework-2023.2.1.dist-info/LICENSE.txt` & `common_framework-2023.5.1.dist-info/LICENSE.txt`

 * *Files identical despite different names*

## Comparing `common_framework-2023.2.1.dist-info/METADATA` & `common_framework-2023.5.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,31 +1,34 @@
 Metadata-Version: 2.1
 Name: common-framework
-Version: 2023.2.1
+Version: 2023.5.1
 Summary: All-in-one framework for Django and Django REST Framework
 Home-page: https://github.com/debnet/common-framework
 Author: Marc Debureaux
 Author-email: marc@debureaux.fr
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Environment :: Web Environment
 Classifier: Framework :: Django
 Classifier: Framework :: Django :: 3.0
 Classifier: Framework :: Django :: 3.1
 Classifier: Framework :: Django :: 3.2
 Classifier: Framework :: Django :: 4.0
+Classifier: Framework :: Django :: 4.1
+Classifier: Framework :: Django :: 4.2
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Programming Language :: Python
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
+Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Utilities
 Description-Content-Type: text/markdown
 License-File: LICENSE.txt
 Requires-Dist: Django (>=3)
 Requires-Dist: djangorestframework (>=3)
 
 # Framework commun
```

## Comparing `common_framework-2023.2.1.dist-info/RECORD` & `common_framework-2023.5.1.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,39 +1,39 @@
-common/__init__.py,sha256=W304skeQLo954GbvxLl5tHArQXiANoK5agtPqSnXy3E,103
+common/__init__.py,sha256=q3RvaHuypl12GHzBPFxyiM-LPdJjGT30Bk6josPnguo,103
 common/admin.py,sha256=0zwE6Qq_sD60Nds4EWn0Rkg2726nOjv6w_K3KgJq9_s,25165
 common/apps.py,sha256=Rm00kplkzdk1mR1EhLa4nGb0D_ImQWYlEcbLvduQE1k,625
 common/auth.py,sha256=1itJcvKdlMQ97-vYawpyKJiWJtiv2DLXDIIzh1kDz6E,4053
 common/commands.py,sha256=_TnINchAhIHkmlPG-CJtdHxZmECpPSkuVNXGyxKNuXs,4559
 common/excel.py,sha256=046lBpnh6lqXRDb0tMc4bAQCUGtscw_B0Dxjbt0EmC0,23004
 common/fields.py,sha256=ZaSsxz2WqXB03Zm1isw8y0sL3st8ARGRwYbi7LyUn-4,27464
 common/forms.py,sha256=RtF595roeFklnSVz-hnyiCrwcxoRFTOazVMBhfH8RlY,13777
 common/logger.py,sha256=EDqklCVVVxkEMUtJho2ktR02ydkllgyYHlijSE2pziw,4310
 common/middleware.py,sha256=fr1jfE7dbZ6M3mCjPqnNWUB_Bl8oyhof8VqEMiP1INU,4939
-common/models.py,sha256=gA8Ch6sqUgrpxXSIHrB69rbFmDtm265s_EcC0y19RXU,98921
+common/models.py,sha256=gWJTxDqHD43SRHYHcaJycnH3kRJEtxLiyjMks3Qgv6U,100327
 common/operations.py,sha256=Cdrr1esuI1othAn5-jDXBKVSJTZnGlZ_7hwRyd7NwJE,6171
 common/router.py,sha256=nwI8bS4_lpNYJqIcFeLennsj0hM43qosxATNFOXPkZM,4886
 common/runtests.py,sha256=jWpOn6cGwL7ltZA2Vek_Je02ApoMX9KOmccxSktZIUA,3802
 common/settings.py,sha256=_R-aGadqvXqAHsYr6SE-Bv0zSgkXzdO3mw02cu_luo8,1361
 common/tasks.py,sha256=K65cN6S4wLHiZo_iH9Bg9qNRVsgYIbmTgj6c6THKJ8o,103
 common/urls.py,sha256=XH6YNsNSs_b54oxQGP1HT-1dx8eeIJNzcuGlXtWRCjQ,448
-common/utils.py,sha256=rTZ24UfO4LwsWkGAIneXopMkO72MLtg8hrMcXam-6qU,66910
+common/utils.py,sha256=LYT97hgkmchfDC5pWnO5FCizZrU37jKnznUQaLgK_TQ,67037
 common/views.py,sha256=s3D1WZFcMfPNjwzZOmzHlztPuekMOkC_9RIkzWpOu3E,2956
 common/websocket.py,sha256=czztR0ydxOnnkygakXhkuWOn8dACzEuhG_S2FwNeDis,2760
 common/api/__init__.py,sha256=Hc0g8HMsO3WRghOQdRyaLC9zjc2pRrVAB24uYcIfmH0,16
 common/api/api_views.py,sha256=H1kEiToVcwyJhjWxClQ14lGUDSVMqlNoOPRJ2krrTy0,5107
 common/api/base.py,sha256=5q2UWgJX434GEqmujZvW6gnq0Z2keX5yEXRt17udBKI,2501
 common/api/config.py,sha256=UHGQf-eQYnsEKlmxnAsrl9JTmDjvRrZhDnsKXAAsxHA,1730
 common/api/fields.py,sha256=kJBbeG47c0AWTljTSG9ssBfFlUBd8N5eWxm1ZKBXnss,5887
 common/api/input_serializers.py,sha256=IKPAi_xn4A8crr9GzVQpXHQYcie9vbPLmTkwIf0JW2Y,1521
 common/api/pagination.py,sha256=aob4_JN65LVsfumfxIZiME2xLzxDTH3URCD79U4uBNY,1928
 common/api/permissions.py,sha256=R7D1CJAdZmefsUGv3kJB49R04vMld8rnxG1w-wJBoO8,1778
 common/api/renderers.py,sha256=Drr9No47Ic7jNVND6PoG0cIhZdLYXgvguaWZLCJZNgE,1237
 common/api/serializers.py,sha256=me5ReTvEZBs6b4zK8ewqjEpgh5hoL8Xg2LfsP5yAqSs,12660
 common/api/urls.py,sha256=Voc8Xs2Hf_HjXUCiUJGnVfQnymm2k04sGV8DGcSoAeU,768
-common/api/utils.py,sha256=yDq2il9Nc7_vA_LJCEdqXGK-DNvZ1GZbDx_iJWkZ7bc,60710
+common/api/utils.py,sha256=4JrAaJFaVYLmqkSx0AhgfVjtt3yCRWU0zZFx7szpp38,63718
 common/api/viewsets.py,sha256=ByNArRI5B6Dl2osHuIMgQ8A2Kd56avH-5Xa8HLHnY_0,25786
 common/locale/en/LC_MESSAGES/django.mo,sha256=9Gwg_39ACVoUc-mnRkPMH6bOfO8NnWWmbPzGp9tpZx8,13644
 common/locale/en/LC_MESSAGES/django.po,sha256=L1sjFHk5NSQ0y_O3-ExpG40kED1GRstu_shUPtxHJUE,13366
 common/locale/fr/LC_MESSAGES/django.mo,sha256=2XqJy6Zbj4BskU65NaVHRmynzD-7zJSNoxtNvzzmJwg,14751
 common/locale/fr/LC_MESSAGES/django.po,sha256=0WD179BMH9QpBIOLPaJPhCiCCRK4sL3nXsTb8oAMHbo,14473
 common/management/__init__.py,sha256=qzEiZSOALgbxPd39Uwug4FOJvKkba1PDyWXIlVmdmws,713
 common/management/commands/__init__.py,sha256=3CpLhn4rzlaCDOr5INBfiYiXV-n61qnFFFhEK7PB7Qo,29
@@ -60,12 +60,12 @@
 common/templates/common/scripts.js,sha256=Ln4Je2BCvNmozwj8TDuT2EpXXnMV1g49-QqgosJRAcM,6391
 common/templatetags/__init__.py,sha256=3CpLhn4rzlaCDOr5INBfiYiXV-n61qnFFFhEK7PB7Qo,29
 common/templatetags/tools.py,sha256=2lMF0PT5jM4SrybT8QUhvBGF9YOd495scs6sFwDJ76w,15293
 common/tests/__init__.py,sha256=5Mm89cMYnx-2Fo8qxHPggWFe4j0jZwKcY-JbHPZR8Gc,25744
 common/tests/test_api.py,sha256=Org2-tt3dli6tbhTSVFNNQGFUxRxv3F-Vmt6py3pDPs,311
 common/tests/test_utils.py,sha256=NqAZVx0AbpOnJgLX0lgC40k86j3nbBWQ-agrwIrS7P0,8252
 common/tests/urls.py,sha256=3aNUECjS544gIr3JVa9SzOnGY5WbTZ-EoEL6K9Iylms,494
-common_framework-2023.2.1.dist-info/LICENSE.txt,sha256=-cTHe6o4KABO5UuKTy2y6I7USmI3pJOWW_VR-sD8ti0,1023
-common_framework-2023.2.1.dist-info/METADATA,sha256=wtOtd8EuM5ns89QH204vqnNW6Q0aJn6gKy11M5kPets,22963
-common_framework-2023.2.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-common_framework-2023.2.1.dist-info/top_level.txt,sha256=-_7pXzjkl9sfbAGjSmzh04NkWEI9H92fmklj4bkMUpo,114
-common_framework-2023.2.1.dist-info/RECORD,,
+common_framework-2023.5.1.dist-info/LICENSE.txt,sha256=-cTHe6o4KABO5UuKTy2y6I7USmI3pJOWW_VR-sD8ti0,1023
+common_framework-2023.5.1.dist-info/METADATA,sha256=axwboLyTsq8iVy_xytLFuLOiGzriD4hbgUJy0qd5J0A,23092
+common_framework-2023.5.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+common_framework-2023.5.1.dist-info/top_level.txt,sha256=-_7pXzjkl9sfbAGjSmzh04NkWEI9H92fmklj4bkMUpo,114
+common_framework-2023.5.1.dist-info/RECORD,,
```

