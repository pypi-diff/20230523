# Comparing `tmp/steampunk_spotter-1.2.8rc1-py3-none-any.whl.zip` & `tmp/steampunk_spotter-1.2.9a1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,38 +1,38 @@
-Zip file size: 60851 bytes, number of entries: 36
--rw-r--r--  2.0 unx        0 b- defN 23-May-18 07:16 spotter/__init__.py
--rw-r--r--  2.0 unx    18318 b- defN 23-May-16 07:59 spotter/api.py
--rw-r--r--  2.0 unx     5239 b- defN 23-May-16 07:59 spotter/cli.py
+Zip file size: 62297 bytes, number of entries: 36
+-rw-r--r--  2.0 unx        0 b- defN 23-May-23 07:00 spotter/__init__.py
+-rw-r--r--  2.0 unx    22727 b- defN 23-May-23 06:35 spotter/api.py
+-rw-r--r--  2.0 unx     5343 b- defN 23-May-23 06:35 spotter/cli.py
 -rw-r--r--  2.0 unx    18318 b- defN 23-Apr-19 09:32 spotter/environment.py
 -rw-r--r--  2.0 unx    24098 b- defN 23-May-05 10:47 spotter/parsing.py
 -rw-r--r--  2.0 unx     5697 b- defN 23-Apr-19 09:32 spotter/storage.py
 -rw-r--r--  2.0 unx     2752 b- defN 23-Mar-20 10:29 spotter/utils.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-18 07:16 spotter/commands/__init__.py
--rw-r--r--  2.0 unx     3952 b- defN 23-May-16 12:40 spotter/commands/clear_policies.py
--rw-r--r--  2.0 unx     2347 b- defN 23-May-16 07:59 spotter/commands/login.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-23 07:00 spotter/commands/__init__.py
+-rw-r--r--  2.0 unx     4839 b- defN 23-May-23 06:35 spotter/commands/clear_policies.py
+-rw-r--r--  2.0 unx     2446 b- defN 23-May-23 06:35 spotter/commands/login.py
 -rw-r--r--  2.0 unx     2253 b- defN 23-Apr-19 09:32 spotter/commands/logout.py
 -rw-r--r--  2.0 unx     1141 b- defN 23-May-08 13:52 spotter/commands/register.py
--rw-r--r--  2.0 unx    39164 b- defN 23-May-16 13:35 spotter/commands/scan.py
--rw-r--r--  2.0 unx     5209 b- defN 23-May-16 12:40 spotter/commands/set_policies.py
+-rw-r--r--  2.0 unx    39573 b- defN 23-May-23 06:35 spotter/commands/scan.py
+-rw-r--r--  2.0 unx     6063 b- defN 23-May-23 06:35 spotter/commands/set_policies.py
 -rw-r--r--  2.0 unx     3620 b- defN 23-May-05 08:29 spotter/commands/suggest.py
 -rw-r--r--  2.0 unx       60 b- defN 23-Mar-14 07:59 spotter/reporting/__init__.py
 -rw-r--r--  2.0 unx     3459 b- defN 23-Mar-14 07:59 spotter/reporting/report.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-18 07:16 spotter/rewriting/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-23 07:00 spotter/rewriting/__init__.py
 -rw-r--r--  2.0 unx     7545 b- defN 23-Apr-11 07:05 spotter/rewriting/models.py
 -rw-r--r--  2.0 unx     7538 b- defN 23-Apr-17 18:18 spotter/rewriting/processor.py
 -rw-r--r--  2.0 unx     1937 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_action_inline.py
 -rw-r--r--  2.0 unx     2318 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_action_object.py
 -rw-r--r--  2.0 unx      989 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_always_run.py
 -rw-r--r--  2.0 unx      982 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_fqcn.py
 -rw-r--r--  2.0 unx     2087 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_inline.py
 -rw-r--r--  2.0 unx     2527 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_local_action_inline.py
 -rw-r--r--  2.0 unx     2312 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_local_object.py
 -rw-r--r--  2.0 unx      989 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_module_inline.py
 -rw-r--r--  2.0 unx      888 b- defN 23-Apr-11 07:05 spotter/rewriting/rewrite_module_object.py
--rw-rw-rw-  2.0 unx    11358 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/LICENSE
--rw-r--r--  2.0 unx    22528 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/WHEEL
--rw-r--r--  2.0 unx       45 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        8 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/top_level.txt
--rw-r--r--  2.0 unx        1 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/zip-safe
--rw-rw-r--  2.0 unx     3152 b- defN 23-May-18 07:17 steampunk_spotter-1.2.8rc1.dist-info/RECORD
-36 files, 202923 bytes uncompressed, 55747 bytes compressed:  72.5%
+-rw-rw-rw-  2.0 unx    11358 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/LICENSE
+-rw-r--r--  2.0 unx    22527 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       45 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        8 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/top_level.txt
+-rw-r--r--  2.0 unx        1 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/zip-safe
+-rw-rw-r--  2.0 unx     3145 b- defN 23-May-23 07:00 steampunk_spotter-1.2.9a1.dist-info/RECORD
+36 files, 209677 bytes uncompressed, 57207 bytes compressed:  72.7%
```

## zipnote {}

```diff
@@ -81,29 +81,29 @@
 
 Filename: spotter/rewriting/rewrite_module_inline.py
 Comment: 
 
 Filename: spotter/rewriting/rewrite_module_object.py
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/LICENSE
+Filename: steampunk_spotter-1.2.9a1.dist-info/LICENSE
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/METADATA
+Filename: steampunk_spotter-1.2.9a1.dist-info/METADATA
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/WHEEL
+Filename: steampunk_spotter-1.2.9a1.dist-info/WHEEL
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/entry_points.txt
+Filename: steampunk_spotter-1.2.9a1.dist-info/entry_points.txt
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/top_level.txt
+Filename: steampunk_spotter-1.2.9a1.dist-info/top_level.txt
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/zip-safe
+Filename: steampunk_spotter-1.2.9a1.dist-info/zip-safe
 Comment: 
 
-Filename: steampunk_spotter-1.2.8rc1.dist-info/RECORD
+Filename: steampunk_spotter-1.2.9a1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## spotter/api.py

```diff
@@ -16,28 +16,31 @@
     DEFAULT_HEADERS = {
         "Accept": "application/json",
         "User-Agent": f"steampunk-spotter/{get_current_cli_version()}"
     }
     DEFAULT_TIMEOUT = 10
 
     def __init__(self, base_url: str, storage: Storage, api_token: Optional[str], username: Optional[str],
-                 password: Optional[str]):
+                 password: Optional[str], debug: bool = False):
         """
         Construct ApiClient object.
 
         :param base_url: Base API endpoint url
         :param storage: Storage object, where tokens are stored
         :param username: Username
         :param password: Password
+        :param debug: Enable debug mode
         """
         self._base_url = base_url.rstrip("/")
         self._storage = storage
         self._api_token = api_token
         self._username = username
         self._password = password
+        self._debug = debug
+        self._me: Optional[Dict[str, Any]] = None
 
         self._storage_tokens_path = "tokens" if self._storage.exists("tokens") else "tokens.json"
         if self._storage_tokens_path == "tokens":
             self._old_tokens_fallback()
 
     def _url(self, path: str) -> str:
         """
@@ -141,14 +144,106 @@
         if self._storage.exists(self._storage_tokens_path):
             tokens = self._storage.read_json(self._storage_tokens_path)
             endpoint_tokens = tokens.get(self._base_url, {})
 
         endpoint_tokens.update(updated_tokens)
         self._storage.update_json({self._base_url: endpoint_tokens}, self._storage_tokens_path)
 
+    def debug_print(self, message: str, *args: str) -> None:
+        """
+        Print a message to the standard error stream if the debug mode is enabled.
+
+        :param message: The message to print with any lazy formatting.
+        :param args: Optional arguments to be used in the formatting.
+        """
+        if self._debug:
+            print(message.format(*args), file=sys.stderr)
+
+    def _get_me(self) -> Dict[str, Any]:
+        if self._me is None:
+            response = self.get(path="/v2/users/me/")
+            if response.status_code != 200:
+                print(self.format_api_error(response), file=sys.stderr)
+            self._me = response.json()
+
+        return self._me
+
+    def _debug_print_organization(self, message: str, organization: Dict[str, Any]) -> None:
+        self.debug_print(f"{message} ({organization['id']}) {organization['name']}")
+
+    def _debug_print_subscription(self, subscription: Dict[str, Any]) -> None:
+        self.debug_print(
+            f"Subscription plan {subscription['plan_type']}, {subscription['status']} "
+            f"expires {subscription['end_date']}, "
+            f"custom policies {'allowed' if subscription['custom_policies_enabled'] else 'not allowed'}"
+        )
+
+    def debug_project(self, project_id: str) -> None:
+        """
+        If in debug mode, fetch and print the information about the selected project.
+
+        :param project_id: UUID of the project to obtain and print the details of.
+        """
+        if not self._debug:
+            return
+        me = self._get_me()  # pylint: disable=invalid-name
+        organization: Optional[Dict[str, Any]] = None
+        for org in me["organizations"]:
+            if project_id in org["projects"]:
+                organization = org
+                break
+        if organization is None:
+            self.debug_print(f"Project with id {project_id} not found in any of my organizations")
+        else:
+            self._debug_print_organization("Project found in organization:", organization)
+            self._debug_print_subscription(organization["subscription"])
+
+    def debug_print_me(self) -> None:
+        """If in debug mode, fetch and print the information about myself."""
+        if not self._debug:
+            return
+        self.debug_print(f"API endpoint: {self._base_url}")
+        me = self._get_me()  # pylint: disable=invalid-name
+        self.debug_print(
+            f"Logged in as ({me['id']}) {me['username']} - {me['first_name']}"
+            f" {me['last_name']} <{me['email']}>"
+        )
+
+    def debug_organization(self, organization_id: str) -> None:
+        """
+        If in debug mode, fetch and print the information about this organization.
+
+        :param organization_id: UUID of the organization to print the details of.
+        """
+        if not self._debug:
+            return
+        me = self._get_me()  # pylint: disable=invalid-name
+        org_matches = [o for o in me["organizations"] if o["id"] == organization_id]
+        if len(org_matches) < 1:
+            self.debug_print(
+                f"Organization id {organization_id} not found for any of my organizations"
+            )
+        else:
+            self._debug_print_organization("Target organization:", org_matches[0])
+            self._debug_print_subscription(org_matches[0]["subscription"])
+
+    def debug_my_default_organization(self) -> None:
+        """If in debug mode, fetch and print the information about my default organization."""
+        if not self._debug:
+            return
+        me = self._get_me()  # pylint: disable=invalid-name
+        try:
+            default_organization_id = me["default_organization"]
+            default_organization = [o for o in me["organizations"] if o["id"] == default_organization_id][0]
+            self._debug_print_organization("Default organization", default_organization)
+            self.debug_print(f"Projects: {default_organization['projects']}")
+            self._debug_print_subscription(default_organization["subscription"])
+        except Exception as e:  # pylint: disable=broad-exception-caught
+            print(f"Error obtaining default organization info: {e}", file=sys.stderr)
+
     def login(self, timeout: int = DEFAULT_TIMEOUT) -> None:
         """
         Login user to the API using API token or username and password, also verify and store auth tokens to storage.
 
         Note that we do not use self._request to prevent possible cyclic recursion errors.
 
         :param timeout: Request timeout
@@ -171,14 +266,16 @@
                 print(self.format_api_error(response), file=sys.stderr)
                 sys.exit(2)
 
         # verify auth tokens and save them to storage
         response = requests.get(self._url("/v3/auth/verify/"), headers=request_headers, timeout=timeout)
         if response.ok:
             self._update_endpoint_tokens(updated_auth_tokens)
+            self.debug_print_me()
+            self.debug_my_default_organization()
         else:
             print(self.format_api_error(response), file=sys.stderr)
             sys.exit(2)
 
     def _refresh_login(self, timeout: int = DEFAULT_TIMEOUT) -> None:
         """
         Login user to the API using the tokens (access and refresh token) from storage.
```

## spotter/cli.py

```diff
@@ -78,14 +78,17 @@
     )
     parser.add_argument(
         "--password", "-p", type=str, help="Steampunk Spotter password"
     )
     parser.add_argument(
         "--no-colors", action="store_true", help="Disable output colors"
     )
+    parser.add_argument(
+        "--debug", "-D", action="store_true", help="Enable debug output"
+    )
 
     subparsers = parser.add_subparsers()
     subparsers_metavar = ""
     cmds = [
         (register.__name__.rsplit(".", maxsplit=1)[-1], register),
         (login.__name__.rsplit(".", maxsplit=1)[-1], login),
         (logout.__name__.rsplit(".", maxsplit=1)[-1], logout),
```

## spotter/commands/clear_policies.py

```diff
@@ -40,33 +40,50 @@
     :param args: Argparse arguments
     """
     api_endpoint = args.endpoint or os.environ.get("SPOTTER_ENDPOINT", None)
     storage_path = args.storage_path or Storage.DEFAULT_PATH
     api_token = args.api_token or os.environ.get("SPOTTER_API_TOKEN")
     username = args.username or os.environ.get("SPOTTER_USERNAME")
     password = args.password or os.environ.get("SPOTTER_PASSWORD")
+    debug = args.debug
 
-    clear_policies(api_endpoint, storage_path, api_token, username, password, args.project_id, args.organization_id)
+    clear_policies(api_endpoint, storage_path, api_token, username, password, args.project_id, args.organization_id,
+                   debug=debug)
+
+
+def _debug_print_project_and_org(api_client: ApiClient, project_id: Optional[str],
+                                 organization_id: Optional[str]) -> None:
+    if project_id is not None:
+        api_client.debug_print("Clearing polices for project id {}", project_id)
+        api_client.debug_project(project_id)
+    elif organization_id is not None:
+        api_client.debug_print("Clearing polices for organization id {}", organization_id)
+        api_client.debug_organization(organization_id)
+    else:
+        api_client.debug_print("Clearing polices for default organization")
+        api_client.debug_my_default_organization()
 
 
 # pylint: disable=too-many-arguments,too-many-locals
 def clear_policies(api_endpoint: Optional[str], storage_path: Path, api_token: Optional[str], username: Optional[str],
-                   password: Optional[str], project_id: Optional[str], organization_id: Optional[str]) -> None:
+                   password: Optional[str], project_id: Optional[str], organization_id: Optional[str],
+                   debug: bool = False) -> None:
     """
     Clear custom OPA policies.
 
     By default, this will clear policies that belong to the default project from personal organization.
 
     :param api_endpoint: Steampunk Spotter API endpoint
     :param storage_path: Path to storage
     :param api_token: Steampunk Spotter API token
     :param username: Steampunk Spotter username
     :param password: Steampunk Spotter password
     :param project_id: UUID of an existing Steampunk Spotter project to clear custom policies from
     :param organization_id: UUID of an existing Steampunk Spotter organization to clear custom policies from
+    :param debug: Enable debug mode
     """
     storage = Storage(storage_path)
 
     # TODO: extract this to a separate configuration component along with other configuration file options
     if api_endpoint is None:
         if storage.exists("spotter.json"):
             storage_configuration_json = storage.read_json("spotter.json")
@@ -78,15 +95,17 @@
 
     payload: Dict[str, Any] = {
         "policies": [],
         "project_id": project_id,
         "organization_id": organization_id
     }
 
-    api_client = ApiClient(endpoint, storage, api_token, username, password)
+    api_client = ApiClient(endpoint, storage, api_token, username, password, debug=debug)
+    api_client.debug_print_me()
+    _debug_print_project_and_org(api_client, project_id, organization_id)
     response = api_client.put("/v2/opa/", payload=payload, ignore_response_status_codes=True)
     if response.status_code == 403:
         print("The use of custom policies is only available in Spotter's ENTERPRISE plan. "
               "Please upgrade your plan to use this functionality.")
         sys.exit(0)
     if not response.ok:
         print(api_client.format_api_error(response), file=sys.stderr)
```

## spotter/commands/login.py

```diff
@@ -33,34 +33,35 @@
     username = args.username or os.environ.get("SPOTTER_USERNAME")
     password = args.password or os.environ.get("SPOTTER_PASSWORD")
     if not api_token and not username:
         username = input("Username: ")
     if not api_token and not password:
         password = getpass()
 
-    login(api_endpoint, storage_path, api_token, username, password)
+    login(api_endpoint, storage_path, api_token, username, password, debug=args.debug)
     print("Login successful!")
 
 
 def login(api_endpoint: str, storage_path: Path, api_token: Optional[str], username: Optional[str],
-          password: Optional[str]) -> None:
+          password: Optional[str], debug: bool = False) -> None:
     """
     Do user login.
 
     :param api_endpoint: Steampunk Spotter API endpoint
     :param storage_path: Path to storage
     :param api_token: Steampunk Spotter API token
     :param username: Steampunk Spotter username
     :param password: Steampunk Spotter password
+    :param debug: Enable or disable debug mode
     """
     storage = Storage(storage_path)
 
     # TODO: extract this to a separate configuration component along with other configuration file options
     if not api_endpoint:
         if storage.exists("spotter.json"):
             storage_configuration_json = storage.read_json("spotter.json")
             api_endpoint = storage_configuration_json.get("endpoint", ApiClient.DEFAULT_ENDPOINT)
         else:
             api_endpoint = ApiClient.DEFAULT_ENDPOINT
 
-    api_client = ApiClient(api_endpoint, storage, api_token, username, password)
+    api_client = ApiClient(api_endpoint, storage, api_token, username, password, debug=debug)
     api_client.login()
```

## spotter/commands/scan.py

```diff
@@ -759,14 +759,15 @@
     :param args: Argparse arguments
     """
     api_endpoint = args.endpoint or os.environ.get("SPOTTER_ENDPOINT", "")
     storage_path = args.storage_path or Storage.DEFAULT_PATH
     api_token = args.api_token or os.environ.get("SPOTTER_API_TOKEN")
     username = args.username or os.environ.get("SPOTTER_USERNAME")
     password = args.password or os.environ.get("SPOTTER_PASSWORD")
+    debug = args.debug
     scan_paths = args.path
 
     if args.import_payload and scan_paths:
         print("Error: the --import-payload is mutually exclusive with positional arguments.", file=sys.stderr)
         sys.exit(2)
 
     if args.export_payload and not scan_paths or (
@@ -802,24 +803,24 @@
     # ensure that colorized output is possible only when output is text-formatted and to be printed to the console
     if args.output or args.format != OutputFormat.TEXT:
         args.no_colors = True
 
     scan(api_endpoint, storage_path, api_token, username, password, args.no_colors, args.project_id, args.config,
          config_vars, args.include_values, args.include_metadata, args.rewrite, args.display_level, args.profile,
          args.skip_checks, args.no_docs_url, args.format, args.output, args.import_payload, args.export_payload,
-         scan_paths)
+         scan_paths, debug=debug)
 
 
 # pylint: disable=too-many-arguments,too-many-locals,too-many-branches,too-many-statements
 def scan(api_endpoint: str, storage_path: Path, api_token: Optional[str], username: Optional[str],
          password: Optional[str], no_colors: bool, project_id: Optional[str], config_path: Optional[Path],
          config_vars: Dict[str, Any], include_values: bool, include_metadata: bool, rewrite: bool,
          display_level: DisplayLevel, profile: Profile, skip_checks: List[str], no_docs_url: bool,
          output_format: OutputFormat, output_path: Optional[Path], import_payload: Optional[Path],
-         export_payload: Optional[Path], scan_paths: List[Path]) -> None:
+         export_payload: Optional[Path], scan_paths: List[Path], debug: bool = False) -> None:
     """
     Scan Ansible content and return scan result.
 
     :param api_endpoint: Steampunk Spotter API endpoint
     :param storage_path: Path to storage
     :param api_token: Steampunk Spotter API token
     :param username: Steampunk Spotter username
@@ -839,14 +840,15 @@
     :param skip_checks: List of check IDs for checks to be skipped
     :param no_docs_url: Disable outputting URLs to documentation
     :param output_format: for the scan result
     :param output_path: Output file path where the formatted scan result will be exported to
     :param import_payload: Path to the previously exported file to be sent for scanning
     :param export_payload: Path to export the locally scanned data without sending anything for scanning to the server
     :param scan_paths: Path to Ansible artifact or directory
+    :param debug: Enable debug mode
     """
     # create and set environment
     # the order that we read configuration is the following (in each step we overwrite what the previous one has):
     # 1. local discovery (from user's current workspace)
     # 2. config file (JSON/YAML file provided after --config flag)
     # 3. options provided as key=value pairs to the scan command
     environment = Environment.from_local_discovery(scan_paths)
@@ -892,22 +894,27 @@
         if not api_endpoint:
             if storage.exists("spotter.json"):
                 storage_configuration_json = storage.read_json("spotter.json")
                 api_endpoint = storage_configuration_json.get("endpoint", ApiClient.DEFAULT_ENDPOINT)
             else:
                 api_endpoint = ApiClient.DEFAULT_ENDPOINT
 
-        api_client = ApiClient(api_endpoint, storage, api_token, username, password)
+        api_client = ApiClient(api_endpoint, storage, api_token, username, password, debug=debug)
+        api_client.debug_print_me()
 
         if project_id:
+            api_client.debug_print("Scanning with project id {}", project_id)
+            api_client.debug_project(project_id)
             scan_start_time = time.time()
             response = api_client.post(f"/v3/scans/?project={project_id}", payload=pydantic_encoder(scan_payload),
                                        timeout=120)
             scan_time = time.time() - scan_start_time
         else:
+            api_client.debug_print("Scanning with default organization and project")
+            api_client.debug_my_default_organization()
             scan_start_time = time.time()
             response = api_client.post("/v3/scans/", payload=pydantic_encoder(scan_payload), timeout=120)
             scan_time = time.time() - scan_start_time
 
         try:
             response_json = response.json()
         except json.JSONDecodeError as e:
```

## spotter/commands/set_policies.py

```diff
@@ -44,45 +44,61 @@
     :param args: Argparse arguments
     """
     api_endpoint = args.endpoint or os.environ.get("SPOTTER_ENDPOINT", None)
     storage_path = args.storage_path or Storage.DEFAULT_PATH
     api_token = args.api_token or os.environ.get("SPOTTER_API_TOKEN")
     username = args.username or os.environ.get("SPOTTER_USERNAME")
     password = args.password or os.environ.get("SPOTTER_PASSWORD")
+    debug = args.debug
 
     path: Path = args.path
     if not path.exists():
         print(f"Error: Path at {path} provided for scanning does not exist.", file=sys.stderr)
         sys.exit(2)
     if not path.is_file() and not path.is_dir():
         print(f"Error: Path at {path} is not a file or directory.", file=sys.stderr)
         sys.exit(2)
 
     include_policies(
-        api_endpoint, storage_path, api_token, username, password, args.project_id, args.organization_id, path
+        api_endpoint, storage_path, api_token, username, password, args.project_id, args.organization_id, path,
+        debug=debug
     )
 
 
+def _debug_print_project_and_org(api_client: ApiClient, project_id: Optional[str],
+                                 organization_id: Optional[str]) -> None:
+    if project_id is not None:
+        api_client.debug_print("Setting polices for project id {}", project_id)
+        api_client.debug_project(project_id)
+    elif organization_id is not None:
+        api_client.debug_print("Setting polices for organization id {}", organization_id)
+        api_client.debug_organization(organization_id)
+    else:
+        api_client.debug_print("Setting polices for default organization")
+        api_client.debug_my_default_organization()
+
+
 # pylint: disable=too-many-arguments,too-many-locals
 def include_policies(api_endpoint: Optional[str], storage_path: Path, api_token: Optional[str], username: Optional[str],
                      password: Optional[str], project_id: Optional[str], organization_id: Optional[str],
-                     path: Path) -> None:
+                     path: Path, debug: bool = False) -> None:
     """
     Set custom OPA policies.
 
     By default, this will set policies for the default project from personal organization.
 
     :param api_endpoint: Steampunk Spotter API endpoint
     :param storage_path: Path to storage
     :param api_token: Steampunk Spotter API token
     :param username: Steampunk Spotter username
     :param password: Steampunk Spotter password
     :param project_id: UUID of an existing Steampunk Spotter project to set custom policies for
     :param organization_id: UUID of an existing Steampunk Spotter organization to set custom policies for
     :param path: Path to the file or folder with custom OPA policies (written in Rego Language)
+    :param debug: Enable debug mode
     """
     storage = Storage(storage_path)
 
     # TODO: extract this to a separate configuration component along with other configuration file options
     if api_endpoint is None:
         if storage.exists("spotter.json"):
             storage_configuration_json = storage.read_json("spotter.json")
@@ -115,15 +131,17 @@
 
     payload = {
         "policies": policies,
         "project_id": project_id,
         "organization_id": organization_id
     }
 
-    api_client = ApiClient(endpoint, storage, api_token, username, password)
+    api_client = ApiClient(endpoint, storage, api_token, username, password, debug=debug)
+    api_client.debug_print_me()
+    _debug_print_project_and_org(api_client, project_id, organization_id)
     response = api_client.put("/v2/opa/", payload=payload, ignore_response_status_codes=True)
     if response.status_code == 403:
         print("The use of custom policies is only available in Spotter's ENTERPRISE plan. "
               "Please upgrade your plan to use this functionality.")
         sys.exit(0)
     if not response.ok:
         print(api_client.format_api_error(response), file=sys.stderr)
```

## Comparing `steampunk_spotter-1.2.8rc1.dist-info/LICENSE` & `steampunk_spotter-1.2.9a1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `steampunk_spotter-1.2.8rc1.dist-info/METADATA` & `steampunk_spotter-1.2.9a1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: steampunk-spotter
-Version: 1.2.8rc1
+Version: 1.2.9a1
 Summary: Ansible Playbook Scanning Tool
 Home-page: https://spotter.steampunk.si/
 Author: XLAB d.o.o.
 Author-email: pypi@xlab.si
 Project-URL: Source Code, https://gitlab.com/xlab-steampunk/steampunk-spotter-client/spotter-cli
 Project-URL: Bug Tracker, https://gitlab.com/xlab-steampunk/steampunk-spotter-client/spotter-cli/-/issues
 Project-URL: Documentation, https://gitlab.com/xlab-steampunk/steampunk-spotter-client/spotter-cli
```

## Comparing `steampunk_spotter-1.2.8rc1.dist-info/RECORD` & `steampunk_spotter-1.2.9a1.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,21 +1,21 @@
 spotter/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-spotter/api.py,sha256=zGSJj_ITZkFGv8M2vJlfro2IYc-t5f4Rw-CgvyQYsAU,18318
-spotter/cli.py,sha256=yU5UPWqSiNDhxzBdFTDgHrB-WGgRaDiMXM1q-GnwqXk,5239
+spotter/api.py,sha256=F-pbx3pQ12Hv4h5y4k56yRGWwXSWkwR27CHmATcxOo8,22727
+spotter/cli.py,sha256=fRxh5SokNRMWsYCn8vU1Cy4c9HSXB5xw_sMRMZdgtMo,5343
 spotter/environment.py,sha256=V8UehBSiH0pZThbYCpj7RYigoRDM8O201HhrMopYK14,18318
 spotter/parsing.py,sha256=VC721TuonMHSMgJeUlhfd8ho4UQvSPAlAzgd1y7wWto,24098
 spotter/storage.py,sha256=JP8CrsxCugpOXpR6fwiTzqmlbXCLwtZiGJ8Dbm-tUjA,5697
 spotter/utils.py,sha256=n6xPBZAHwhemTtFYivo0WFHxK01ir77SsrnooW6B75w,2752
 spotter/commands/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-spotter/commands/clear_policies.py,sha256=UYp-xNrBTp4T--694Lw-jTaLI8uioG8teBm8IQivuAc,3952
-spotter/commands/login.py,sha256=lOEU1IPLdSWxFLxnTsRbhCrxkTNdadwcintmLDn7b4g,2347
+spotter/commands/clear_policies.py,sha256=IyD10Xk3U3i8ZuGCThBD6uAxTOWaGhG0elH7w6ArL28,4839
+spotter/commands/login.py,sha256=pnvZSRIC-k8q7d1M3OCAx3omr-atMbiSdnoEnBWq1bU,2446
 spotter/commands/logout.py,sha256=8YQ7YbX-kgg4748MbSruCri0aAoKRygTxkU74F9Kp5c,2253
 spotter/commands/register.py,sha256=BstH64-72XM-1-xAZgrn__b55qpLAFnajF8UfrOmxU8,1141
-spotter/commands/scan.py,sha256=rtU_MYhUjLU2Yq88IMRlk47xHKbfY5Wdd0XjVGMwiHQ,39164
-spotter/commands/set_policies.py,sha256=-zkzrT9cso3J7eg9tezCDk5s2jgSP79mBC1l2ouIi9Y,5209
+spotter/commands/scan.py,sha256=0V-0WLKRLI4oX0NirOkff0ToWAeietNago1x0imdiVQ,39573
+spotter/commands/set_policies.py,sha256=nolqnWTBRNE7E6k1rzt4vGTlrpaXG70skaK6Api5P9Y,6063
 spotter/commands/suggest.py,sha256=MIcYTOoV8v4TrTovvu3_tv50-H_4i52_wCXLiIGEpoU,3620
 spotter/reporting/__init__.py,sha256=Mddj7lJk3d9SeIpItBD_NNURRF4vtyMahTomdOFAEDw,60
 spotter/reporting/report.py,sha256=LXBXWhXvWa39l-UvLq0-5ts0dK_uCRCfayvUGm0g5kQ,3459
 spotter/rewriting/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 spotter/rewriting/models.py,sha256=RCPpJ8j4Hig2RYpC_pEYKnOlRBOuPmyddBucX9RM8z4,7545
 spotter/rewriting/processor.py,sha256=12KJvO_g6I3qTRcevPJp_h4mSutOEWMZahF4Os_Mp7k,7538
 spotter/rewriting/rewrite_action_inline.py,sha256=pmu0onrt4DPDwhmVh_DlD7ceCg_rTyjz1lLOjQfZOa4,1937
@@ -23,14 +23,14 @@
 spotter/rewriting/rewrite_always_run.py,sha256=UxH-gjRr8rEGaXzT9dp4bOaFXXMaCE7vFc2jO_7B3Fw,989
 spotter/rewriting/rewrite_fqcn.py,sha256=bHjFL68p5Kx-aRBmsvlUPu4fsDbVcsDdaw0v61IvDC0,982
 spotter/rewriting/rewrite_inline.py,sha256=AWwOpqYTtokaLN65bCpPWbPqHOwYkh4b-B5NwP9quBc,2087
 spotter/rewriting/rewrite_local_action_inline.py,sha256=TTv4rF8EPSapapDShP9-Tk0ZOPHXXjiW7LluVShrYqU,2527
 spotter/rewriting/rewrite_local_object.py,sha256=oEdZsSmMf7AS9jXbUxmmYoePId2c48yJQ8pqvQsBOrE,2312
 spotter/rewriting/rewrite_module_inline.py,sha256=blQEkNzfCAiyr2nJJuTNXdj8jyVAESLzfA4cfhttRto,989
 spotter/rewriting/rewrite_module_object.py,sha256=tK5KNRCIn0ibwXwmwgAk8nKKIyOCADmsYOPsX3lcWiY,888
-steampunk_spotter-1.2.8rc1.dist-info/LICENSE,sha256=z8d0m5b2O9McPEK1xHG_dWgUBT6EfBDz6wA0F7xSPTA,11358
-steampunk_spotter-1.2.8rc1.dist-info/METADATA,sha256=jCLdA3YiaTqYY3g5WrQP6MkORpJXiYBAwBJ5OMOmQZg,22528
-steampunk_spotter-1.2.8rc1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-steampunk_spotter-1.2.8rc1.dist-info/entry_points.txt,sha256=_94aMdgSgx7FY17kO5nvQ5NaEqYQM1oetU0Iwq2NK6c,45
-steampunk_spotter-1.2.8rc1.dist-info/top_level.txt,sha256=3FpgMM0g2fECUU_GuaBTKGXYeWTG5uDxJXqqRD3YTck,8
-steampunk_spotter-1.2.8rc1.dist-info/zip-safe,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-steampunk_spotter-1.2.8rc1.dist-info/RECORD,,
+steampunk_spotter-1.2.9a1.dist-info/LICENSE,sha256=z8d0m5b2O9McPEK1xHG_dWgUBT6EfBDz6wA0F7xSPTA,11358
+steampunk_spotter-1.2.9a1.dist-info/METADATA,sha256=sjV6Xiy8WJp_jfCcBzg94iHYefFjjNFhuA1OqvXKQOE,22527
+steampunk_spotter-1.2.9a1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+steampunk_spotter-1.2.9a1.dist-info/entry_points.txt,sha256=_94aMdgSgx7FY17kO5nvQ5NaEqYQM1oetU0Iwq2NK6c,45
+steampunk_spotter-1.2.9a1.dist-info/top_level.txt,sha256=3FpgMM0g2fECUU_GuaBTKGXYeWTG5uDxJXqqRD3YTck,8
+steampunk_spotter-1.2.9a1.dist-info/zip-safe,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
+steampunk_spotter-1.2.9a1.dist-info/RECORD,,
```

